<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="Michael Lisboa: I'm a UX designer, creative director, illustrator, programmer, start-up founder, and a really good guy who specializes in the creative use of technology to invent and design unforgettable user experiences." name="description"><meta content="user experience, consumer experience, digital strategy, marketing, advertising, programming, python, react" name="keywords"><meta content="width=device-width,initial-scale=1" name="viewport"><title>Michael Lisboa's Portfolio</title><link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"><link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"><link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"><link href="/safari-pinned-tab.svg" rel="mask-icon" color="#37474f"><meta content="#37474f" name="msapplication-TileColor"><meta content="#37474f" name="theme-color"><meta content="484644278572308" property="fb:app_id"><meta content="https://www.hypermix.com/" property="og:url"><meta content="Michael Lisboa's Portfolio" property="og:title"><meta content="A UX designer, creative director, illustrator, programmer, start-up founder, and a really good guy specializing in the creative use of technology to invent & design unforgettable user experiences." property="og:description"><meta content="website" property="og:type"><meta content="/astro-logo-1200.png" property="og:image"><meta content="Michael Lisboa's Portfolio" property="og:site_name"><meta content="en_US" property="og:locale"><meta content="summary" name="twitter:card"><meta content="@MichaelLisboaCD" name="twitter:site"><meta content="@MichaelLisboaCD" name="twitter:creator"><meta content="https://www.hypermix.com/" name="twitter:url"><meta content="Michael Lisboa's Portfolio" name="twitter:title"><meta content="A UX designer, creative director, illustrator, programmer, start-up founder, and a really good guy specializing in the creative use of technology to invent & design unforgettable user experiences." name="twitter:description"><meta content="/astro-logo-1200.png" name="twitter:image:src"><link href="/favicon.ico" rel="shortcut icon"><link href="/manifest.json" rel="manifest"><link href="https://fonts.googleapis.com/css?family=Roboto:400,600,700,900|Maven+Pro:400,500,600|Bitter:400,700" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.3/css/uikit.min.css" rel="stylesheet"><script src="https://www.google-analytics.com/analytics.js" async></script><script type="text/javascript">!function(i){if(i.search){var l={};i.search.slice(1).split("&").forEach(function(i){var a=i.split("=");l[a[0]]=a.slice(1).join("=").replace(/~and~/g,"&")}),void 0!==l.p&&window.history.replaceState(null,null,i.pathname.slice(0,-1)+(l.p||"")+(l.q?"?"+l.q:"")+i.hash)}}(window.location)</script><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://cdnjs.cloudflare.com" rel="preconnect"><link href="http://cdn.embedly.com" rel="preconnect"><link href="/static/css/main.23f1c8db.chunk.css" rel="stylesheet"><link href="https://www.google-analytics.com" rel="preconnect"><link href="https://cdn.contentful.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="http://images.ctfassets.net" rel="preconnect"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="navbar-container uk-sticky uk-sticky-fixed" style="position:fixed;top:0;width:480px" data-uk-sticky="true"><div class="anim-nav-container uk-hidden@s" style="background:rgba(236,239,241,0);width:80px;height:60px"><div class="uk-padding-small uk-position-fixed" style="margin-top:8px"><span class="uk-float-left uk-icon" data-uk-icon="icon: menu; ratio: 0.9"><svg data-svg="menu" height="18" viewBox="0 0 20 20" width="18" xmlns="http://www.w3.org/2000/svg"><rect height="1" width="16" x="2" y="4"></rect><rect height="1" width="16" x="2" y="9"></rect><rect height="1" width="16" x="2" y="14"></rect></svg></span><small class="uk-float-left uk-text-middle"> MENU</small></div></div><nav class="uk-navbar-container uk-navbar" data-uk-navbar="true"><div class="uk-navbar-center uk-hidden@s"><a href="/" class="uk-navbar-item uk-logo active" aria-current="page"><img alt="Astro Logo" width="60px" data-uk-image="true" src="/static/media/astro-logo.3658d8d2.svg"></a></div><div class="uk-navbar-left uk-margin-medium-left uk-visible@s"><a href="/" class="home-icon uk-link-muted uk-link-reset"><i class="uk-icon" data-uk-icon="icon: arrow-left; ratio: 0.95;"><svg data-svg="arrow-left" height="19" viewBox="0 0 20 20" width="19" xmlns="http://www.w3.org/2000/svg"><polyline points="10 14 5 9.5 10 5" fill="none" stroke="#000"></polyline><line fill="none" stroke="#000" x1="16" x2="5" y1="9.5" y2="9.52"></line></svg></i><i class="uk-icon" data-uk-icon="icon: home; ratio: 0.75;"><svg data-svg="home" height="15" viewBox="0 0 20 20" width="15" xmlns="http://www.w3.org/2000/svg"><polygon points="18.65 11.35 10 2.71 1.35 11.35 0.65 10.65 10 1.29 19.35 10.65"></polygon><polygon points="15 4 18 4 18 7 17 7 17 5 15 5"></polygon><polygon points="3 11 4 11 4 18 7 18 7 12 12 12 12 18 16 18 16 11 17 11 17 19 11 19 11 13 8 13 8 19 3 19"></polygon></svg></i></a></div><div class="uk-navbar-center uk-margin-medium-right uk-visible@s"><ul class="uk-navbar-nav"><li><a href="/portfolio"><span class="uk-icon" data-uk-icon="icon: grid; ratio: 0.75"><svg data-svg="grid" height="15" viewBox="0 0 20 20" width="15" xmlns="http://www.w3.org/2000/svg"><rect height="3" width="3" x="2" y="2"></rect><rect height="3" width="3" x="8" y="2"></rect><rect height="3" width="3" x="14" y="2"></rect><rect height="3" width="3" x="2" y="8"></rect><rect height="3" width="3" x="8" y="8"></rect><rect height="3" width="3" x="14" y="8"></rect><rect height="3" width="3" x="2" y="14"></rect><rect height="3" width="3" x="8" y="14"></rect><rect height="3" width="3" x="14" y="14"></rect></svg></span> Work</a></li><li><a href="/rates"><span class="uk-icon" data-uk-icon="icon: bolt; ratio: 0.75"><svg data-svg="bolt" height="15" viewBox="0 0 20 20" width="15" xmlns="http://www.w3.org/2000/svg"><path d="M4.74,20 L7.73,12 L3,12 L15.43,1 L12.32,9 L17.02,9 L4.74,20 L4.74,20 L4.74,20 Z M9.18,11 L7.1,16.39 L14.47,10 L10.86,10 L12.99,4.67 L5.61,11 L9.18,11 L9.18,11 L9.18,11 Z"></path></svg></span>Rates</a></li><li><a href="/" class="uk-navbar-item uk-logo uk-visible@s active" aria-current="page"><img alt="Astro logo" width="55px" data-uk-image="true" src="/static/media/astro-logo.3658d8d2.svg"></a></li><li><a href="/resume"><span class="uk-icon" data-uk-icon="icon: list; ratio: 0.75"><svg data-svg="list" height="15" viewBox="0 0 20 20" width="15" xmlns="http://www.w3.org/2000/svg"><rect height="1" width="12" x="6" y="4"></rect><rect height="1" width="12" x="6" y="9"></rect><rect height="1" width="12" x="6" y="14"></rect><rect height="1" width="2" x="2" y="4"></rect><rect height="1" width="2" x="2" y="9"></rect><rect height="1" width="2" x="2" y="14"></rect></svg></span> Resume</a></li><li><a href="/blog"><span class="uk-icon" data-uk-icon="icon: future; ratio: 0.75"><svg data-svg="future" height="15" viewBox="0 0 20 20" width="15" xmlns="http://www.w3.org/2000/svg"><polyline points="19 2 18 2 18 6 14 6 14 7 19 7 19 2"></polyline><path d="M18,6.548 C16.709,3.29 13.354,1 9.6,1 C4.6,1 0.6,5 0.6,10 C0.6,15 4.6,19 9.6,19 C14.6,19 18.6,15 18.6,10" fill="none" stroke="#000" stroke-width="1.1"></path><rect height="7" width="1" x="9" y="4"></rect><path d="M13.018,14.197 L9.445,10.625" fill="none" stroke="#000" stroke-width="1.1"></path></svg></span> Waste</a></li></ul></div></nav></div><div class="uk-sticky-placeholder" style="height:60px;margin:0"></div><main><section class="uk-section uk-article"><div class="uk-container uk-container-small"><p class="uk-text-bold uk-h2 uk-margin-remove-adjacent uk-margin-remove-top">Using Python and Pandas With Google BigQuery.</p><p class="uk-article-meta">Posted on March 30, 2019</p><p class="uk-text-lead uk-margin-bottom">In this "how to", we'll be using Django to query a dataset, format that data using Pandas, then pushing the DataFrame to Google BigQuery as our data warehouse.</p></div><div class="post-content uk-container uk-container-small"><p>Influen$e relies heavily on data generated through multiple micro-services and API calls, all in real time. Early on, I wanted to set up the platform to use Google BigQuery for data warehousing, allowing us to work with real-time data in smaller chunks.</p><div><section class="uk-section uk-section-small"><div class="content-box uk-container uk-container-small uk-padding-small uk-width-1-2@s"><h4 class="uk-text-center">Shortcut this</h4><h5 class="uk-text-center">If you know what you're doing, you can get the code from GitHub.</h5><div class="uk-text-center"><a href="https://github.com/MichaelLisboa/python-pandas-bigquery" class="uk-button uk-button-large uk-button-secondary">Get it on GitHub</a></div></div></section></div><h4>Trying to make a complicated set up as easy as possible to implement.</h4><p>When I first started researching how to do this, it all seemed really complicated. I was scouring the web and reading articles, pulling little bits of useful information from many different sources.</p><p>In the end, I came up with a hacked together solution that I refined down to, what I believe, is the simplest execution.</p><h5>What we're going to do.</h5><ol><li>Query data in Django.</li><li>Model that data, using Pandas, to a workable DataFrame.</li><li>Push the data to Google BigQuery.</li><li>Create a Cron job to run nightly pushes.</li></ol><p>While this is a real-world example, the point of this exercise is to get a basic understanding of the steps required for setting it all up. So, I'll simplify things by only using a single query.</p><h4>Setting up Google BigQuery.</h4><p>I'm going to skip setting up a Google Cloud project, assuming you've already made it this far. We'll start with getting BigQuery set up.</p><p>First, you need to go <a href="https://console.cloud.google.com/flows/enableapi?apiid=bigquery&_ga=2.182927334.-1396141278.1552049696&pli=1&angularJsUrl=%2Fflows%2Fenableapi%3Fapiid%3Dbigquery%26_ga%3D2.182927334.-1396141278.1552049696%26pli%3D1&authuser=1" title="Google BigQuery API">here and enable the API in your Google Project</a></p><p>Google has a really really good walkthrough of <a href="https://cloud.google.com/bigquery/docs/quickstarts/quickstart-web-ui" title="BigQuery quick start">setting up the environment here.</a></p><p>Once you have the API setup in your project, an option for BigQuery should be present in your console menu. There you'll see a screen like this:</p><p><img alt="gbq-step-1" src="//images.ctfassets.net/1nc0h0ipk4bl/1Lq8v6SU2cElAFp8KD8Aoo/356cf0a9e7bc4516a69e4469aae19ecd/gbq-step-1.png"></p><h5>Create a DataSet</h5><p>Clicking on the "Create Dataset" button will display this screen:</p><p><img alt="gbq-step-2" src="//images.ctfassets.net/1nc0h0ipk4bl/cTzGLGf0wk0RV7QAIa5J1/fbf739ee665c0c3fc066bd22fbf533aa/gbq-step-2.png"></p><p>Name your DataSet, in this case I'm calling it <code>MyDataId</code>, and choose the zone closest to you. For me, I've selected Singapore. Go ahead and click the Create DataSet button to get your first DataSet set up in BigQuery.</p><p>Now that we have a DataSet, we need to add tables to it. To keep things simple, we're going to add only one table. Select your <code>MyDataId</code>, and click Create Table to add a new empty table and call it <code>MyDataTable</code>. Don't worry about other settings at the moment, an empty table that's editable as text works for our case.</p><p><img alt="gbq-step-5" src="//images.ctfassets.net/1nc0h0ipk4bl/IZGItB3zAIT8qPBVj0Uz0/a46b41bb175fd7fb40d3f3894320f8a2/gbq-step-5.png"></p><p>Okay, we now have a DataSet with an empty table set up. We'll be able to reference our table in Python using <code>MyDataId.MyDataTable</code>.</p><h5>Let's make our Django View.</h5><p>Go to your Django app <code>views.py</code> and create a new function. I'm calling it <code>push_bigquery()</code>. We'll start with creating a queryset for "MyMembers":</p><pre style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b'><code style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">db</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">Count</span>
<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">db</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">functions</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">TruncDate</span>
<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">http</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">HttpResponse</span>

<span class="token module" style="color:#cc7832">import</span> pandas <span class="token module" style="color:#cc7832">as</span> pd
<span class="token module" style="color:#cc7832">from</span> common<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">MyMembersModel</span>


def <span class="token" style="color:#ffc66d">push_bigquery</span><span class="token" style="color:#a9b7c6">(</span>request<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">:</span>
    members_qs <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
        <span class="token maybe-class-name">MyMembersModel</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token property-access">objects</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">prefetch_related</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">"profile__thing"</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">annotate</span><span class="token" style="color:#a9b7c6">(</span>
            created_date<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#ffc66d"><span class="token maybe-class-name">TruncDate</span></span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'profile__thing__timestamp'</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">,</span>
            count<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#ffc66d"><span class="token maybe-class-name">Count</span></span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'profile__thing'</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">order_by</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'created_date'</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">distinct</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>
    <span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">values</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'created_date'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'name'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'slug'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'count'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'profile__thing'</span><span class="token" style="color:#a9b7c6">)</span>
    
members_df <span class="token" style="color:#a9b7c6">=</span> pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d"><span class="token maybe-class-name">DataFrame</span></span><span class="token" style="color:#a9b7c6">(</span>members_qs<span class="token" style="color:#a9b7c6">)</span></code></pre><p>What we've done here is query our <code>MyMembers</code> table and related <code>Things</code>, as <code>values()</code>, which will return a <code>dict</code>-like queryset.</p><p>Sidenote, I'm also truncating the timstamp using <code>TruncDate</code>, which casts the expression to a date rather than using the built-in SQL <code>truncate</code> method.</p><p>Then we create our Pandas DataFrame from the values with <code>members_df = pd.DataFrame(members_qs)</code></p><h5>Basic data modeling.</h5><p>We're going to do some simple modeling to format our DataFrame. Again, we're keeping this simple, I'm assuming you're already knowledgable about formatting data with Pandas.</p><p>Add the following to your function:</p><pre style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b'><code style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'>pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_datetime</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'created_date'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span>
members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">set_index</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'created_date'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">,</span> inplace<span class="token" style="color:#a9b7c6">=</span><span class="token maybe-class-name">True</span><span class="token" style="color:#a9b7c6">)</span>

members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'count_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'count'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span>axis<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">)</span>

members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'label_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">groupby</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'name'</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'count'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>

members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'thing_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
    members_df
    <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">groupby</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">index</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'profile__thing'</span><span class="token" style="color:#a9b7c6">]</span>
    <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>
<span class="token" style="color:#a9b7c6">)</span>

members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'frequency_of_thing'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'label_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">/</span> members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'thing_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">*</span> <span class="token" style="color:#6897bb">100</span>
<span class="token" style="color:#a9b7c6">)</span></code></pre><p>I've started by converting the <code>created_date</code> series to datetime and set it as the index.</p><p>Then we're getting the cumulative sum of the number of "things", and cumulative sum of "labels" associated with "things". And finally the cumulative sum of "things" by each "member".</p><p>Yeah, I know that sounds really confusing...</p><p>We're doing this because we're looking to get the frequency of things <code>members_df['frequency_of_thing']</code> by individual members and comparing that to the whole community.</p><p>Next we want to format our DataFrame by selecting the Series' we want, filtering out any NaN values and resetting the index:</p><pre style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b'><code style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'>members_df <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span>
    <span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'name'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'slug'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'label_cumsum'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'thing_cumsum'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'frequency_of_thing'</span><span class="token" style="color:#a9b7c6">]</span>
<span class="token" style="color:#a9b7c6">]</span>
members_df <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span>pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">notnull</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'thing_cumsum'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">]</span>
members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">reset_index</span><span class="token" style="color:#a9b7c6">(</span>inplace<span class="token" style="color:#a9b7c6">=</span><span class="token maybe-class-name">True</span><span class="token" style="color:#a9b7c6">)</span></code></pre><p>Okay, our <code>members_df</code> is where we want it so we can push it to BigQuery. You'll find this frustratingly simple:</p><pre style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b'><code style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'>members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_gbq</span><span class="token" style="color:#a9b7c6">(</span>
    <span class="token" style="color:#6a8759">'MyDataId.MyDataTable'</span><span class="token" style="color:#a9b7c6">,</span>
    project_id<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">'your-gcp-project'</span><span class="token" style="color:#a9b7c6">,</span>
    if_exists<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">'replace'</span>
<span class="token" style="color:#a9b7c6">)</span></code></pre><p>That's it.</p><p>We're using Pandas <code>to_gbq</code> to send our DataFrame to BigQuery.</p><ul><li><code>'MyDataId.MyDataTable'</code> references the DataSet and table we created earlier.</li><li><code>project_id</code> is obviously the ID of your Google Cloud project.</li><li><code>if_exists</code> is set to replace the content of the BigQuery table if the table already exists.</li></ul><h5>About if_exists.</h5><p>In this case, if the table already exists in BigQuery, we're replacing all of the data. You don't want to do that in the real world.</p><p><code>if_exists</code> has a couple of other arguments,</p><ul><li><code>fail</code>, which raises an exception if you try to write to the table, and</li><li><code>append</code> which is our preferred option in this case, which will append your data to the existing table.</li></ul><h5>One other thing</h5><p>In my case, not only do I want to push all my data to BigQuery, I also wanted a subset of that data for fast lookups across different services. To do this I pickeled the last 3 months of my dataset with:</p><pre style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b'><code style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'>members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">last</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'3M'</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_pickle</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'members_df.pkl'</span><span class="token" style="color:#a9b7c6">)</span></code></pre><p>Our final function looks like this:</p><pre style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b'><code style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'><span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">db</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">Count</span>
<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">db</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">functions</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">TruncDate</span>
<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">http</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">HttpResponse</span>

<span class="token module" style="color:#cc7832">import</span> pandas <span class="token module" style="color:#cc7832">as</span> pd
<span class="token module" style="color:#cc7832">from</span> common<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">MyMembersModel</span>


def <span class="token" style="color:#ffc66d">push_bigquery</span><span class="token" style="color:#a9b7c6">(</span>request<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">:</span>
    members_qs <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
        <span class="token maybe-class-name">MyMembersModel</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token property-access">objects</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">prefetch_related</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">"profile__thing"</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">annotate</span><span class="token" style="color:#a9b7c6">(</span>
            created_date<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#ffc66d"><span class="token maybe-class-name">TruncDate</span></span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'profile__thing__timestamp'</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">,</span>
            count<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#ffc66d"><span class="token maybe-class-name">Count</span></span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'profile__thing'</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">order_by</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'created_date'</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">distinct</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>
      <span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">values</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'created_date'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'name'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'slug'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'count'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'profile__thing'</span><span class="token" style="color:#a9b7c6">)</span>

    members_df <span class="token" style="color:#a9b7c6">=</span> pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d"><span class="token maybe-class-name">DataFrame</span></span><span class="token" style="color:#a9b7c6">(</span>members_qs<span class="token" style="color:#a9b7c6">)</span>

    pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_datetime</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'created_date'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span>
    members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">set_index</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'created_date'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">,</span> inplace<span class="token" style="color:#a9b7c6">=</span><span class="token maybe-class-name">True</span><span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'count_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'count'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span>axis<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'label_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">groupby</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'name'</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'count'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'thing_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
        members_df
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">groupby</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">index</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'profile__thing'</span><span class="token" style="color:#a9b7c6">]</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>
    <span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'frequency_of_thing'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
        members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'label_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">/</span> members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'thing_cumsum'</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">*</span> <span class="token" style="color:#6897bb">100</span>
    <span class="token" style="color:#a9b7c6">)</span>

    members_df <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span>
        <span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'name'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'slug'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'label_cumsum'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'thing_cumsum'</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">'frequency_of_thing'</span><span class="token" style="color:#a9b7c6">]</span>
    <span class="token" style="color:#a9b7c6">]</span>
    members_df <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span>pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">notnull</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">'thing_cumsum'</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">]</span>
    members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">reset_index</span><span class="token" style="color:#a9b7c6">(</span>inplace<span class="token" style="color:#a9b7c6">=</span><span class="token maybe-class-name">True</span><span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_gbq</span><span class="token" style="color:#a9b7c6">(</span>
        <span class="token" style="color:#6a8759">'MyDataId.MyDataTable'</span><span class="token" style="color:#a9b7c6">,</span>
        project_id<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">'your-gcp-project'</span><span class="token" style="color:#a9b7c6">,</span>
        if_exists<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">'replace'</span>
    <span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">last</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'3M'</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_pickle</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">'members_df.pkl'</span><span class="token" style="color:#a9b7c6">)</span>

    <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#ffc66d"><span class="token maybe-class-name">HttpResponse</span></span><span class="token" style="color:#a9b7c6">(</span>status<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6897bb">200</span><span class="token" style="color:#a9b7c6">)</span></code></pre><p>We could do a bit more optimization with Pandas and Threading, but this is good enough for the purpose of this article.</p><h5>Google Cloud App Engine & Cron jobs</h5><p>We're going to set up a Cron job on Google App Engine to run our BigQuery program nightly.</p><p>Let's create a url pattern for our <code>push_bigquery</code> view and add it to the app urls.py:</p><pre style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b'><code style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'># app<span class="token" style="color:#a9b7c6">/</span>urls<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">py</span>

<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">conf</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">urls</span> <span class="token module" style="color:#cc7832">import</span> url

<span class="token module" style="color:#cc7832">from</span> <span class="token" style="color:#a9b7c6">.</span> <span class="token module" style="color:#cc7832">import</span> views

urlpatterns <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">[</span>

    <span class="token spread" style="color:#a9b7c6">...</span> other url patterns <span class="token spread" style="color:#a9b7c6">...</span>
    
    <span class="token method property-access" style="color:#ffc66d">url</span><span class="token" style="color:#a9b7c6">(</span>
        r<span class="token" style="color:#6a8759">'^push-gbq/$'</span><span class="token" style="color:#a9b7c6">,</span>
        views<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">push_bigquery</span>
    <span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">,</span>
<span class="token" style="color:#a9b7c6">]</span></code></pre><p>Now you should be able to visit <a href="http://localhost:8000/push-gbq/">http://localhost:8000/push-gbq/</a> and the function will run, cerating the DataFrame, pushing it to BigQuery, and pickeling your DataFrame.</p><p>To make sure it works, take a look at BigQuery in your Google Cloud Console. You should see your table update with your data. Also, you should see a new <code>.pkl</code> file called "members_df.pkl" in your local project root directory.</p><p>Next, in your project root directory, create a file called <code>cron.yaml</code> and add this:</p><pre style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b'><code style='color:#a9b7c6;font-family:Consolas,Monaco,"Andale Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;tab-size:4;hyphens:none'># root<span class="token" style="color:#a9b7c6">/</span>cron<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">yaml</span>

cron<span class="token" style="color:#a9b7c6">:</span>
<span class="token" style="color:#a9b7c6">-</span> description<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#6a8759">"Push GBQ CRON"</span>
  url<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="background:#364135"><span class="token regex-delimiter">/</span><span class="token language-regex">push-gbq</span><span class="token regex-delimiter">/</span></span>
  schedule<span class="token" style="color:#a9b7c6">:</span> every <span class="token" style="color:#6897bb">24</span> hours
  retry_parameters<span class="token" style="color:#a9b7c6">:</span>
    min_backoff_seconds<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#6897bb">120</span>
    max_doublings<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#6897bb">5</span></code></pre><p>This creates a Cron job for App Engine that will visit your push_bigquery function at <code>www.your-website/push-gbq/</code> every 24 hours to push your latest data to BigQuery. Depending on your situation, you'll probably want to change the frequency this runs in your <code>cron.yaml</code> file.</p><p>Push the Cron job to App Engine with this terminal command:</p><p><code>gcloud app deploy cron.yaml</code></p><h5>Security</h5><p>Make sure you set up your function to only accept requests with the <code>x-appengine-cron</code> header!</p><p>Now you can deploy your project <code>gcloud app deploy</code> and test your Cron job by clicking the "Run now" button on your Cron page in Google Console.</p></div><div class="uk-container uk-container-small uk-margin-medium"><div class="uk-grid uk-grid-medium uk-child-width-1-2 uk-child-width-1-3@s" data-uk-grid="true" data-uk-lightbox="true"><div class="uk-first-column"><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/1Lq8v6SU2cElAFp8KD8Aoo/356cf0a9e7bc4516a69e4469aae19ecd/gbq-step-1.png"><img alt="" width="300" data-src="//images.ctfassets.net/1nc0h0ipk4bl/1Lq8v6SU2cElAFp8KD8Aoo/356cf0a9e7bc4516a69e4469aae19ecd/gbq-step-1.png" data-uk-img="true"></a></figure></div><div><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/cTzGLGf0wk0RV7QAIa5J1/fbf739ee665c0c3fc066bd22fbf533aa/gbq-step-2.png"><img alt="" width="300" data-src="//images.ctfassets.net/1nc0h0ipk4bl/cTzGLGf0wk0RV7QAIa5J1/fbf739ee665c0c3fc066bd22fbf533aa/gbq-step-2.png" data-uk-img="true"></a></figure></div><div class="uk-grid-margin uk-first-column"><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/7tewmCE7oJX0jzFN3E5wKk/f86a63c1b3dd3290298d48847615ccb3/gbq-step-3.png"><img alt="" width="300" data-src="//images.ctfassets.net/1nc0h0ipk4bl/7tewmCE7oJX0jzFN3E5wKk/f86a63c1b3dd3290298d48847615ccb3/gbq-step-3.png" data-uk-img="true"></a></figure></div><div class="uk-grid-margin"><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/2qeKMLyRhLW0q7hUgdoHgc/8f3306427756afc303e4f77991979d57/gbq-step-4.png"><img alt="" width="300" data-src="//images.ctfassets.net/1nc0h0ipk4bl/2qeKMLyRhLW0q7hUgdoHgc/8f3306427756afc303e4f77991979d57/gbq-step-4.png" data-uk-img="true"></a></figure></div><div class="uk-grid-margin uk-first-column"><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/8laAGPcPtJaWstNVCI0iQ/e252e3f144870a0743c5da5780aa417a/gbq-step-5-detail.png"><img alt="" width="300" data-src="//images.ctfassets.net/1nc0h0ipk4bl/8laAGPcPtJaWstNVCI0iQ/e252e3f144870a0743c5da5780aa417a/gbq-step-5-detail.png" data-uk-img="true"></a></figure></div><div class="uk-grid-margin"><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/IZGItB3zAIT8qPBVj0Uz0/a46b41bb175fd7fb40d3f3894320f8a2/gbq-step-5.png"><img alt="" width="300" data-src="//images.ctfassets.net/1nc0h0ipk4bl/IZGItB3zAIT8qPBVj0Uz0/a46b41bb175fd7fb40d3f3894320f8a2/gbq-step-5.png" data-uk-img="true"></a></figure></div><div class="uk-grid-margin uk-first-column"><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/1joeSzZgWNLbVImOGggaFV/0e89161ef0519856d8ac3a2618776b1e/gbq-step-6.png"><img alt="" width="300" data-src="//images.ctfassets.net/1nc0h0ipk4bl/1joeSzZgWNLbVImOGggaFV/0e89161ef0519856d8ac3a2618776b1e/gbq-step-6.png" data-uk-img="true"></a></figure></div></div></div></section><footer class="uk-container uk-container-expand uk-margin-remove-top uk-padding-remove uk-light" style="background-color:#37474f"><div class="uk-container uk-container-expand uk-padding-remove uk-margin-remove-vertical"><div class="uk-text-center uk-padding uk-padding-remove-horizontal"><span class="uk-text-small uk-text-light">©2019 Michael Lisboa •  <a href="/contact"><span class="uk-icon" data-uk-icon="icon: mail; ratio: 0.75"><svg data-svg="mail" height="15" viewBox="0 0 20 20" width="15" xmlns="http://www.w3.org/2000/svg"><polyline points="1.4,6.5 10,11 18.6,6.5" fill="none" stroke="#000"></polyline><path d="M 1,4 1,16 19,16 19,4 1,4 Z M 18,15 2,15 2,5 18,5 18,15 Z"></path></svg></span> Contact me</a></span></div></div></footer></main></div><script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.3/js/uikit.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.3/js/uikit-icons.min.js"></script><script src="//cdn.embedly.com/widgets/platform.js" async charset="UTF-8"></script><script>!function(l){function e(e){for(var r,t,n=e[0],o=e[1],u=e[2],f=0,i=[];f<n.length;f++)t=n[f],p[t]&&i.push(p[t][0]),p[t]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(l[r]=o[r]);for(s&&s(e);i.length;)i.shift()();return c.push.apply(c,u||[]),a()}function a(){for(var e,r=0;r<c.length;r++){for(var t=c[r],n=!0,o=1;o<t.length;o++){var u=t[o];0!==p[u]&&(n=!1)}n&&(c.splice(r--,1),e=f(f.s=t[0]))}return e}var t={},p={1:0},c=[];function f(e){if(t[e])return t[e].exports;var r=t[e]={i:e,l:!1,exports:{}};return l[e].call(r.exports,r,r.exports,f),r.l=!0,r.exports}f.m=l,f.c=t,f.d=function(e,r,t){f.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},f.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.t=function(r,e){if(1&e&&(r=f(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(f.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var n in r)f.d(t,n,function(e){return r[e]}.bind(null,n));return t},f.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return f.d(r,"a",r),r},f.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},f.p="/";var r=window.webpackJsonp=window.webpackJsonp||[],n=r.push.bind(r);r.push=e,r=r.slice();for(var o=0;o<r.length;o++)e(r[o]);var s=n;a()}([])</script><script src="/static/js/2.a083259b.chunk.js"></script><script src="/static/js/main.64b700bf.chunk.js"></script></body></html>